# ðŸš€ Universal Payment Protocol - Render Deployment Guide

## Quick Deployment Steps

### 1. **Prepare Your Repository**
```bash
# Make sure all files are committed and pushed to GitHub
git add .
git commit -m "feat: Add Render deployment configuration"
git push origin trunk
```

### 2. **Connect to Render**
1. Go to [Render Dashboard](https://dashboard.render.com)
2. Click "New" â†’ "Blueprint"
3. Connect your GitHub repository: `UniversalPaymentProtocol`
4. Select the `trunk` branch
5. Render will automatically detect the `render.yaml` file

### 3. **Configure Environment Variables**
In the Render dashboard, set these **secret** environment variables:

```bash
# Required - Stripe Configuration
STRIPE_SECRET_KEY=sk_live_your_live_stripe_secret_key_here
STRIPE_PUBLISHABLE_KEY=pk_live_your_live_stripe_publishable_key_here

# Security (auto-generated by Render, but you can set custom ones)
JWT_SECRET=your-super-secure-jwt-secret-minimum-32-characters-long
CARD_ENCRYPTION_KEY=your-32-character-encryption-key-for-cards-here

# Optional - Logging
LOG_LEVEL=info
ENABLE_AUDIT_LOGGING=true
```

### 4. **Domain Configuration**
Since you already have `realconnect.online`:
1. In Render dashboard â†’ Your service â†’ Settings â†’ Custom Domains
2. Add: `upp.realconnect.online`
3. Update your DNS to point to Render's provided URL
4. SSL certificate will be automatically provisioned

---

## ðŸ”’ **Security Checklist**

### âœ… **PCI DSS Compliance**
- [x] **Encrypted data transmission** (HTTPS enforced)
- [x] **Secure data storage** (AES-256-GCM encryption)
- [x] **Access controls** (JWT authentication)
- [x] **Network security** (Render's built-in firewall)
- [x] **Regular security updates** (Auto-updates enabled)
- [x] **Audit logging** (Comprehensive logging system)

### âœ… **Production Security Settings**
```bash
# In Render dashboard, ensure these are set:
NODE_ENV=production
PCI_COMPLIANCE_MODE=true
ENABLE_TOKENIZATION=true
ENABLE_FRAUD_DETECTION=true
```

---

## ðŸ“Š **Monitoring & Scaling**

### **Built-in Monitoring**
- **Health checks**: `/health` endpoint monitored every 30s
- **Uptime monitoring**: 99.99% SLA with Render
- **Auto-scaling**: Enabled based on CPU/memory usage
- **Logs**: Real-time logs in Render dashboard

### **Recommended Upgrades for Production**
```yaml
# In render.yaml, upgrade plans:
web service: "standard" or "pro" plan
postgres: "standard" plan  
redis: "standard" plan
```

---

## ðŸ’° **Cost Estimation**

### **Starter Setup** (Good for testing/low traffic)
- Web Service (Starter): $7/month
- PostgreSQL (Starter): $7/month  
- Redis (Starter): $7/month
- **Total: ~$21/month**

### **Production Setup** (Recommended)
- Web Service (Standard): $25/month
- PostgreSQL (Standard): $20/month
- Redis (Standard): $20/month
- **Total: ~$65/month**

---

## ðŸš¦ **Deployment Commands**

### **Deploy from GitHub**
```bash
# Automatic deployment on git push to trunk branch
git push origin trunk
```

### **Manual Deploy**
```bash
# In Render dashboard â†’ Manual Deploy
# Or use Render CLI:
render deploy
```

### **View Logs**
```bash
# In Render dashboard â†’ Logs
# Or use CLI:
render logs --service upp-server
```

---

## ðŸ”§ **Troubleshooting**

### **Common Issues**

1. **Build Fails**
   ```bash
   # Check Node.js version in logs
   # Ensure package.json has correct engines field
   ```

2. **Database Connection Issues**
   ```bash
   # Verify DATABASE_URL is properly set
   # Check PostgreSQL service is running
   ```

3. **Card Processing Errors**
   ```bash
   # Verify Stripe keys are correctly set
   # Check CARD_ENCRYPTION_KEY is 32 characters
   ```

### **Health Check Endpoints**
- **System Health**: `GET /health`
- **Database Health**: `GET /health/db`
- **Payment Gateway**: `GET /health/stripe`
- **Compliance Status**: `GET /api/card/compliance`

---

## ðŸŽ¯ **Next Steps After Deployment**

1. **Test Card Processing**
   - Visit: `https://upp.realconnect.online/card-demo`
   - Use Stripe test cards for validation

2. **Set Up Monitoring**
   - Configure alerts for downtime
   - Set up transaction monitoring

3. **Enable Production Features**
   - Switch to live Stripe keys
   - Configure webhook endpoints
   - Set up automated backups

4. **Performance Optimization**
   - Enable CDN caching
   - Configure database connection pooling
   - Set up Redis caching

---

## ðŸ“ž **Support**

- **Render Support**: [Render Help Center](https://render.com/docs)
- **UPP Documentation**: See `src/modules/payments/README.md`
- **PCI Compliance**: See `src/modules/payments/COMPLIANCE_AND_LEGAL.md`

---

**ðŸŽ‰ Your Universal Payment Protocol will be live at: `https://upp.realconnect.online`**
